<!DOCTYPE html>
<html>

<head>
  <title>React + Spring</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

</head>

<body>
  <div id='root'></div>

  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.3/toastr.min.js"></script> -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.3/toastr.min.css">
  <!-- <script src="https://fb.me/react-15.0.1.js"></script>
  <script src="https://fb.me/react-dom-15.0.1.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script> -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js">
  </script>
  <script src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>


  <script type="text/babel">
    var EMPLOYEES = [];

class Create extends React.Component {

constructor(props) {
        super(props);
        
        // this.create = this.create.bind(this);
        this.name = this.name.bind(this);
        }

//    create() {
//    return {employees: []};
//  }

 name(event) {
  var self = this;
  self.setState({name: event.target.value});
 }

  render() {
    return ( <div>
    <input type="text" value="name" onClick={this.name} />
    <input type="text" value="age" />
    <input type="text" value="Years" />
    <button >Submit</button>
    </div> );
  }
};
 

  class EmployeeTable extends React.Component {

    constructor(props) {
        super(props);
        
        
        }


 render() {
      
    var rows = [];
    this.props.employees.forEach(function(employee) {
      rows.push(<Employee employee={employee} />);
    });
    return (
        <div className="container">
  <table className="table table-striped">
    <thead>
      <tr>
        <th>Name</th>
        <th>Age</th>
        <th>Years</th>
        <th>Delete</th>
      </tr>
    </thead>
    <tbody>{rows}</tbody>
  </table>
</div>);
  }
};
         
class App extends React.Component {
 

 constructor(props) {
        super(props);
        this.state={
          employees : []
        }
        
        this.loadEmployeesFromServer = this.loadEmployeesFromServer.bind(this);
        // this.getInitialState = this.getInitialState.bind(this);
        // this.componentDidMount = this.componentDidMount.bind(this);
        }


 loadEmployeesFromServer() {
   var self = this;
   $.ajax({
     url: "http://localhost:8080/api/employees"
   }).then(function (data) {
     self.setState({employees: data._embedded.employees});
   });
 }

  //  getInitialState() {
  //    return {employees: []};
  //  }

  //  componentDidMount() {
  //    this.loadEmployeesFromServer();
  //  }
 
 render() {
  
   
  var self = this;
   $.ajax({
     url: "http://localhost:8080/api/employees"
   }).then(function (data) {
     self.setState({employees: data._embedded.employees});
   });
   return (
     <div>
     <Create employees={this.state.employees} />
     <EmployeeTable employees={this.state.employees}/></div> );
      
 }
};


class Employee extends React.Component {

   constructor(props) {
        super(props);
        this.state={
          display: true
        }
        // this.getInitialState = this.getInitialState.bind(this);
        this.handleDelete = this.handleDelete.bind(this);
        // this.componentDidMount = this.componentDidMount.bind(this);
        }


  // getInitialState() {
  //   return {display: true };
  // } 
  handleDelete() {
    var self = this;
    $.ajax({
        type: 'DELETE',
      url: self.props.employee._links.self.href,
      
      success: function(result) {
        self.setState({});
      },
      
    
    });
  }

  render() {
    if (this.state.display==false) return null;
    else return (
      <tr>
        <td>{this.props.employee.name}</td>
        <td>{this.props.employee.age}</td>
        <td>{this.props.employee.years}</td>
        <td>
          <button className="btn btn-info" onClick={this.handleDelete}>Delete</button>
        </td>
      </tr>
    );
  }
}; 
      

        ReactDOM.render(<App />, document.getElementById('root'));
        </script>
</body>

</html>